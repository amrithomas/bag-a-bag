<?php
session_start();
include_once('../conexao.php');

$codigo_aviao = filter_input(INPUT_POST, 'codigo_aviao');
$empresa  = filter_input(INPUT_POST, 'empresa');

// adicionar o avião ao banco
$query = "INSERT INTO aviao (CODIGO_AVIAO, EMPRESA, TOTAL_ASSENTO, CRIADO) VALUES ('$codigo_aviao', '$empresa', DEFAULT, NOW())";
$consulta = mysqli_query($conn, $query);

if (mysqli_insert_id($conn)) {
    // adiciona todos os assentos do aviao (melhor performance)
    $id_aviao = mysqli_insert_id($conn);
    $id = (1+(200*($id_aviao-1)));
    
    $query_assentos_primeira_classe = "INSERT INTO assentos (ID_ASSENTO_CODAVIAO, NUMERO_ASSENTO, OCUPADO, CLASSE, FK_AVIAO)
    VALUES
    ($id+0, 1, 0, 'Primeira', $id_aviao),
    ($id+1, 2, 0, 'Primeira', $id_aviao),
    ($id+2, 3, 0, 'Primeira', $id_aviao),
    ($id+3, 4, 0, 'Primeira', $id_aviao),
    ($id+4, 5, 0, 'Primeira', $id_aviao),
    ($id+5, 6, 0, 'Primeira', $id_aviao),
    ($id+6, 7, 0, 'Primeira', $id_aviao),
    ($id+7, 8, 0, 'Primeira', $id_aviao),
    ($id+8, 9, 0, 'Primeira', $id_aviao),
    ($id+9, 10, 0, 'Primeira', $id_aviao),
    ($id+10, 11, 0, 'Primeira', $id_aviao),
    ($id+11, 12, 0, 'Primeira', $id_aviao),
    ($id+12, 13, 0, 'Primeira', $id_aviao),
    ($id+13, 14, 0, 'Primeira', $id_aviao),
    ($id+14, 15, 0, 'Primeira', $id_aviao),
    ($id+15, 16, 0, 'Primeira', $id_aviao),
    ($id+16, 17, 0, 'Primeira', $id_aviao),
    ($id+17, 18, 0, 'Primeira', $id_aviao),
    ($id+18, 19, 0, 'Primeira', $id_aviao),
    ($id+19, 20, 0, 'Primeira', $id_aviao),
    ($id+20, 21, 0, 'Primeira', $id_aviao),
    ($id+21, 22, 0, 'Primeira', $id_aviao),
    ($id+22, 23, 0, 'Primeira', $id_aviao),
    ($id+23, 24, 0, 'Primeira', $id_aviao),
    ($id+24, 25, 0, 'Primeira', $id_aviao),
    ($id+25, 26, 0, 'Primeira', $id_aviao),
    ($id+26, 27, 0, 'Primeira', $id_aviao),
    ($id+27, 28, 0, 'Primeira', $id_aviao),
    ($id+28, 29, 0, 'Primeira', $id_aviao),
    ($id+29, 30, 0, 'Primeira', $id_aviao),
    ($id+30, 31, 0, 'Primeira', $id_aviao),
    ($id+31, 32, 0, 'Primeira', $id_aviao),
    ($id+32, 33, 0, 'Primeira', $id_aviao),
    ($id+33, 34, 0, 'Primeira', $id_aviao),
    ($id+34, 35, 0, 'Primeira', $id_aviao),
    ($id+35, 36, 0, 'Primeira', $id_aviao),
    ($id+36, 37, 0, 'Primeira', $id_aviao),
    ($id+37, 38, 0, 'Primeira', $id_aviao),
    ($id+38, 39, 0, 'Primeira', $id_aviao),
    ($id+39, 40, 0, 'Primeira', $id_aviao),
    ($id+40, 41, 0, 'Primeira', $id_aviao),
    ($id+41, 42, 0, 'Primeira', $id_aviao),
    ($id+42, 43, 0, 'Primeira', $id_aviao),
    ($id+43, 44, 0, 'Primeira', $id_aviao),
    ($id+44, 45, 0, 'Primeira', $id_aviao),
    ($id+45, 46, 0, 'Primeira', $id_aviao),
    ($id+46, 47, 0, 'Primeira', $id_aviao),
    ($id+47, 48, 0, 'Primeira', $id_aviao),
    ($id+48, 49, 0, 'Primeira', $id_aviao),
    ($id+49, 50, 0, 'Primeira', $id_aviao),
    ($id+50, 51, 0, 'Econômica', $id_aviao),
    ($id+51, 52, 0, 'Econômica', $id_aviao),
    ($id+52, 53, 0, 'Econômica', $id_aviao),
    ($id+53, 54, 0, 'Econômica', $id_aviao),
    ($id+54, 55, 0, 'Econômica', $id_aviao),
    ($id+55, 56, 0, 'Econômica', $id_aviao),
    ($id+56, 57, 0, 'Econômica', $id_aviao),
    ($id+57, 58, 0, 'Econômica', $id_aviao),
    ($id+58, 59, 0, 'Econômica', $id_aviao),
    ($id+59, 60, 0, 'Econômica', $id_aviao),
    ($id+60, 61, 0, 'Econômica', $id_aviao),
    ($id+61, 62, 0, 'Econômica', $id_aviao),
    ($id+62, 63, 0, 'Econômica', $id_aviao),
    ($id+63, 64, 0, 'Econômica', $id_aviao),
    ($id+64, 65, 0, 'Econômica', $id_aviao),
    ($id+65, 66, 0, 'Econômica', $id_aviao),
    ($id+66, 67, 0, 'Econômica', $id_aviao),
    ($id+67, 68, 0, 'Econômica', $id_aviao),
    ($id+68, 69, 0, 'Econômica', $id_aviao),
    ($id+69, 70, 0, 'Econômica', $id_aviao),
    ($id+70, 71, 0, 'Econômica', $id_aviao),
    ($id+71, 72, 0, 'Econômica', $id_aviao),
    ($id+72, 73, 0, 'Econômica', $id_aviao),
    ($id+73, 74, 0, 'Econômica', $id_aviao),
    ($id+74, 75, 0, 'Econômica', $id_aviao),
    ($id+75, 76, 0, 'Econômica', $id_aviao),
    ($id+76, 77, 0, 'Econômica', $id_aviao),
    ($id+77, 78, 0, 'Econômica', $id_aviao),
    ($id+78, 79, 0, 'Econômica', $id_aviao),
    ($id+79, 80, 0, 'Econômica', $id_aviao),
    ($id+80, 81, 0, 'Econômica', $id_aviao),
    ($id+81, 82, 0, 'Econômica', $id_aviao),
    ($id+82, 83, 0, 'Econômica', $id_aviao),
    ($id+83, 84, 0, 'Econômica', $id_aviao),
    ($id+84, 85, 0, 'Econômica', $id_aviao),
    ($id+85, 86, 0, 'Econômica', $id_aviao),
    ($id+86, 87, 0, 'Econômica', $id_aviao),
    ($id+87, 88, 0, 'Econômica', $id_aviao),
    ($id+88, 89, 0, 'Econômica', $id_aviao),
    ($id+89, 90, 0, 'Econômica', $id_aviao),
    ($id+90, 91, 0, 'Econômica', $id_aviao),
    ($id+91, 92, 0, 'Econômica', $id_aviao),
    ($id+92, 93, 0, 'Econômica', $id_aviao),
    ($id+93, 94, 0, 'Econômica', $id_aviao),
    ($id+94, 95, 0, 'Econômica', $id_aviao),
    ($id+95, 96, 0, 'Econômica', $id_aviao),
    ($id+96, 97, 0, 'Econômica', $id_aviao),
    ($id+97, 98, 0, 'Econômica', $id_aviao),
    ($id+98, 99, 0, 'Econômica', $id_aviao),
    ($id+99, 100, 0, 'Econômica', $id_aviao),
    ($id+100, 101, 0, 'Econômica', $id_aviao),
    ($id+101, 102, 0, 'Econômica', $id_aviao),
    ($id+102, 103, 0, 'Econômica', $id_aviao),
    ($id+103, 104, 0, 'Econômica', $id_aviao),
    ($id+104, 105, 0, 'Econômica', $id_aviao),
    ($id+105, 106, 0, 'Econômica', $id_aviao),
    ($id+106, 107, 0, 'Econômica', $id_aviao),
    ($id+107, 108, 0, 'Econômica', $id_aviao),
    ($id+108, 109, 0, 'Econômica', $id_aviao),
    ($id+109, 110, 0, 'Econômica', $id_aviao),
    ($id+110, 111, 0, 'Econômica', $id_aviao),
    ($id+111, 112, 0, 'Econômica', $id_aviao),
    ($id+112, 113, 0, 'Econômica', $id_aviao),
    ($id+113, 114, 0, 'Econômica', $id_aviao),
    ($id+114, 115, 0, 'Econômica', $id_aviao),
    ($id+115, 116, 0, 'Econômica', $id_aviao),
    ($id+116, 117, 0, 'Econômica', $id_aviao),
    ($id+117, 118, 0, 'Econômica', $id_aviao),
    ($id+118, 119, 0, 'Econômica', $id_aviao),
    ($id+119, 120, 0, 'Econômica', $id_aviao),
    ($id+120, 121, 0, 'Econômica', $id_aviao),
    ($id+121, 122, 0, 'Econômica', $id_aviao),
    ($id+122, 123, 0, 'Econômica', $id_aviao),
    ($id+123, 124, 0, 'Econômica', $id_aviao),
    ($id+124, 125, 0, 'Econômica', $id_aviao),
    ($id+125, 126, 0, 'Econômica', $id_aviao),
    ($id+126, 127, 0, 'Econômica', $id_aviao),
    ($id+127, 128, 0, 'Econômica', $id_aviao),
    ($id+128, 129, 0, 'Econômica', $id_aviao),
    ($id+129, 130, 0, 'Econômica', $id_aviao),
    ($id+130, 131, 0, 'Econômica', $id_aviao),
    ($id+131, 132, 0, 'Econômica', $id_aviao),
    ($id+132, 133, 0, 'Econômica', $id_aviao),
    ($id+133, 134, 0, 'Econômica', $id_aviao),
    ($id+134, 135, 0, 'Econômica', $id_aviao),
    ($id+135, 136, 0, 'Econômica', $id_aviao),
    ($id+136, 137, 0, 'Econômica', $id_aviao),
    ($id+137, 138, 0, 'Econômica', $id_aviao),
    ($id+138, 139, 0, 'Econômica', $id_aviao),
    ($id+139, 140, 0, 'Econômica', $id_aviao),
    ($id+140, 141, 0, 'Econômica', $id_aviao),
    ($id+141, 142, 0, 'Econômica', $id_aviao),
    ($id+142, 143, 0, 'Econômica', $id_aviao),
    ($id+143, 144, 0, 'Econômica', $id_aviao),
    ($id+144, 145, 0, 'Econômica', $id_aviao),
    ($id+145, 146, 0, 'Econômica', $id_aviao),
    ($id+146, 147, 0, 'Econômica', $id_aviao),
    ($id+147, 148, 0, 'Econômica', $id_aviao),
    ($id+148, 149, 0, 'Econômica', $id_aviao),
    ($id+149, 150, 0, 'Econômica', $id_aviao),
    ($id+150, 151, 0, 'Econômica', $id_aviao),
    ($id+151, 152, 0, 'Econômica', $id_aviao),
    ($id+152, 153, 0, 'Econômica', $id_aviao),
    ($id+153, 154, 0, 'Econômica', $id_aviao),
    ($id+154, 155, 0, 'Econômica', $id_aviao),
    ($id+155, 156, 0, 'Econômica', $id_aviao),
    ($id+156, 157, 0, 'Econômica', $id_aviao),
    ($id+157, 158, 0, 'Econômica', $id_aviao),
    ($id+158, 159, 0, 'Econômica', $id_aviao),
    ($id+159, 160, 0, 'Econômica', $id_aviao),
    ($id+160, 161, 0, 'Econômica', $id_aviao),
    ($id+161, 162, 0, 'Econômica', $id_aviao),
    ($id+162, 163, 0, 'Econômica', $id_aviao),
    ($id+163, 164, 0, 'Econômica', $id_aviao),
    ($id+164, 165, 0, 'Econômica', $id_aviao),
    ($id+165, 166, 0, 'Econômica', $id_aviao),
    ($id+166, 167, 0, 'Econômica', $id_aviao),
    ($id+167, 168, 0, 'Econômica', $id_aviao),
    ($id+168, 169, 0, 'Econômica', $id_aviao),
    ($id+169, 170, 0, 'Econômica', $id_aviao),
    ($id+170, 171, 0, 'Econômica', $id_aviao),
    ($id+171, 172, 0, 'Econômica', $id_aviao),
    ($id+172, 173, 0, 'Econômica', $id_aviao),
    ($id+173, 174, 0, 'Econômica', $id_aviao),
    ($id+174, 175, 0, 'Econômica', $id_aviao),
    ($id+175, 176, 0, 'Econômica', $id_aviao),
    ($id+176, 177, 0, 'Econômica', $id_aviao),
    ($id+177, 178, 0, 'Econômica', $id_aviao),
    ($id+178, 179, 0, 'Econômica', $id_aviao),
    ($id+179, 180, 0, 'Econômica', $id_aviao),
    ($id+180, 181, 0, 'Econômica', $id_aviao),
    ($id+181, 182, 0, 'Econômica', $id_aviao),
    ($id+182, 183, 0, 'Econômica', $id_aviao),
    ($id+183, 184, 0, 'Econômica', $id_aviao),
    ($id+184, 185, 0, 'Econômica', $id_aviao),
    ($id+185, 186, 0, 'Econômica', $id_aviao),
    ($id+186, 187, 0, 'Econômica', $id_aviao),
    ($id+187, 188, 0, 'Econômica', $id_aviao),
    ($id+188, 189, 0, 'Econômica', $id_aviao),
    ($id+189, 190, 0, 'Econômica', $id_aviao),
    ($id+190, 191, 0, 'Econômica', $id_aviao),
    ($id+191, 192, 0, 'Econômica', $id_aviao),
    ($id+192, 193, 0, 'Econômica', $id_aviao),
    ($id+193, 194, 0, 'Econômica', $id_aviao),
    ($id+194, 195, 0, 'Econômica', $id_aviao),
    ($id+195, 196, 0, 'Econômica', $id_aviao),
    ($id+196, 197, 0, 'Econômica', $id_aviao),
    ($id+197, 198, 0, 'Econômica', $id_aviao),
    ($id+198, 199, 0, 'Econômica', $id_aviao),
    ($id+199, 200, 0, 'Econômica', $id_aviao)";
        
    $consulta = mysqli_query($conn, $query_assentos_primeira_classe);

    // adiciona 50 assentos de primeira classe do aviao
    // for ($i=1; $i <= 50; $i++) {
        // $query_assentos_primeira_classe = "INSERT INTO assentos (ID_ASSENTO_CODAVIAO, NUMERO_ASSENTO, CLASSE, FK_AVIAO) VALUES (($i+(200*($id_aviao-1))), $i, 'Primeira', '$id_aviao')";
        // $consulta = mysqli_query($conn, $query_assentos_primeira_classe);
    // }

    // adiciona 150 assentos de classe economica do aviao
    // for ($i=51; $i <= 200; $i++) {
    //     $query_assentos_primeira_classe = "INSERT INTO assentos (ID_ASSENTO_CODAVIAO, NUMERO_ASSENTO, CLASSE, FK_AVIAO) VALUES (($i+(200*($id_aviao-1))), $i, 'Econômica', '$id_aviao')";
    //     $consulta = mysqli_query($conn, $query_assentos_primeira_classe);
    // }

}
else {
    $_SESSION['msg'] = "<p style='color:red;'>Erro. Não foi possível inserir o avião ao banco de dados. Tente novamente</p>";
    header('Location: ../cadastro_aviao.php');
}

?>
